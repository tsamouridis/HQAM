# HQAM Constellations Detection Techniques

#### Constellation Formation
HQAM constellations consist of hexagonal shaped decision regions offering higher performance in comparison to QAM constellations. For simulation purposes, the team have developed the required algorithms that form [QAM](https://github.com/tsamouridis/HQAM/blob/main/constellations/QAM.m), [Regular HQAM](https://github.com/tsamouridis/HQAM/blob/main/constellations/rHQAM.m) and [Irregular HQAM](https://github.com/tsamouridis/HQAM/blob/main/constellations/irHQAM.m) constellations.


#### Detection based on paper [[1]](#1)
An algorithm for the detection of a received signal is implemented based on [[1]](#1). Given a received symbol $r$, a circle is implemented with centre  the symbol  and radius specified based on the  minimum distance  and  order of the constellation. Every symbol enclosed by this circle is then compared with the received symbol based on the MLD algorithm, which returns the constellation symbol that is nearest to the received signal given a set of candidate symbols. If no symbol is enclosed by this circle, the signal is rather MLD-compared with the external symbols of the constellation of the corresponding quadrant.
 
#### Simulation
In order to validate the robustness of the detection algorithm explained above, a simulation was developed. Firstly, the desired constellation is formed and, given the desired constellation modulation method and size, the modulated signal to be sent to the receiver is simulated for a range of increasing Signal-to-Noise Ratio values. Next, the received signal is generated by adding Gaussian White noise (AWGN) to the simulated sent signal. Given the received signal, detection takes place and the simulation Symbol Error Probability is computed and compared to the theoretical one, calculated following the equations proposed in  [[1]](#1) and  [[2]](#2). 

![SEP_graph](https://user-images.githubusercontent.com/62445672/189519483-7e5ccf5f-f04f-40ae-b05b-ccc525e74b0e.png)

#### Detection using Neural Networks 
The team developed a detection method using a Neural Network as well. More specifically, the [patternet](https://www.mathworks.com/help/deeplearning/ref/patternnet.html;jsessionid=bb8991630a58464b6ca6436a11c9),  a pattern recognition neural network with a hidden layer and a matrix containing the received signal as input, was used. The input matrix consists of the real values of the received signals in its first row, while the second row consists of the imaginary values of the received signal. The neural network output is a matrix containing the respective probabilities for the detection of each signal sent. The neural network was trained using the [train function](https://www.mathworks.com/help/deeplearning/ref/patternnet.html;jsessionid=bb8991630a58464b6ca6436a11c9#mw_48d7230e-913c-4b48-9785-005d1e11de0c) the inputs were a matrix with the low-SNR sent signals and  a matrix with the desired output given the aforementioned sent signals. The desired output was calculated using MLD.

![nn](https://user-images.githubusercontent.com/62445672/189519607-eec3ff05-c769-4cdb-937e-98b8a7c369f9.png)

#### Symbol Energy based Detection  (WIP) 
A detection  algorithm, which operates based on the energy of the symbols,  was developed. More precisely, the algorithm calculates the absolute difference between the square value of the energy of the received symbol and the square value of the energy of the constellation symbols. Every symbol which belongs to another quadrant or is very far away from the received symbol is excepted from the calculation. The minimum of this calculation is then considered to be the detected symbol.

#### References
<a id="1">[1]</a>
 T. K. Oikonomou, S. A. Tegos, D. Tyrovolas, P. D. Diamantoulakis and G. K. Karagiannidis, "On the Error Analysis of Hexagonal-QAM Constellations," in IEEE Communications Letters, vol. 26, no. 8, pp. 1764-1768, Aug. 2022, doi: 10.1109/LCOMM.2022.3179454.

<a id="2">[2]</a>
L. Rugini, "Symbol Error Probability of Hexagonal QAM," in IEEE Communications Letters, vol. 20, no. 8, pp. 1523-1526, Aug. 2016, doi: 10.1109/LCOMM.2016.2574343.

#### Authors 
[Thanasis Tsamouridis](https://github.com/tsamouridis) <br>
[Vasiliki Pappa](https://github.com/valiapp)
